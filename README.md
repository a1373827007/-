# 在线考试系统

一个功能完整的在线考试系统，支持导入Word文档生成考卷，自动计分和答题详情查看。

## 功能特点

- **Word文档导入**: 支持.docx和.doc格式的Word文档
- **智能题目解析**: 自动识别单选题和多选题
- **美观的用户界面**: 现代化的响应式设计
- **实时答题反馈**: 每题答完后立即显示正确答案
- **自动计分**: 单选题10分，多选题20分
- **详细结果报告**: 包含总分、正确率和答题详情
- **移动端适配**: 支持手机和平板设备

## 技术架构

### 前端
- HTML5 + CSS3 + JavaScript
- 响应式设计，支持多设备
- 现代化UI设计，包含动画效果

### 后端
- Python Flask框架
- python-docx库用于Word文档解析
- Flask-CORS支持跨域请求
- SQLite数据库（可选）

## 安装和运行

### 环境要求
- Python 3.11+
- pip包管理器

### 安装步骤

1. 克隆或下载项目文件
2. 进入项目目录：
   ```bash
   cd exam_system_backend
   ```

3. 激活虚拟环境：
   ```bash
   source venv/bin/activate
   ```

4. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

5. 启动服务器：
   ```bash
   python run_server.py
   ```

6. 打开浏览器访问：
   ```
   http://localhost:5001
   ```

## 使用说明

### Word文档格式要求

Word文档应按以下格式组织：

```
单选题
1.题目内容()
A、选项A
B、选项B  
C、选项C
D、选项D
答案:A

多选题
2.题目内容()
A、选项A
B、选项B
C、选项C  
D、选项D
答案:AB
```

### 使用流程

1. **上传文档**: 点击"选择文件"按钮，选择包含题目的Word文档
2. **开始考试**: 文档解析成功后，点击"开始考试"按钮
3. **答题**: 逐题作答，每题答完后点击"提交答案"查看正确答案
4. **查看结果**: 完成所有题目后查看总分和详细结果
5. **重新开始**: 可以重新上传文档进行新的考试

## 计分规则

- **单选题**: 每题10分
- **多选题**: 每题20分
- **总分**: 所有正确题目分数之和
- **正确率**: 正确题目数量 / 总题目数量

## 项目结构

```
exam_system_backend/
├── src/
│   ├── static/          # 前端文件
│   │   ├── index.html   # 主页面
│   │   ├── style.css    # 样式文件
│   │   └── script.js    # JavaScript逻辑
│   ├── routes/          # Flask路由
│   │   ├── exam.py      # 考试相关API
│   │   └── user.py      # 用户相关API
│   ├── models/          # 数据模型
│   └── database/        # 数据库文件
├── venv/                # Python虚拟环境
├── requirements.txt     # Python依赖
├── run_server.py        # 服务器启动脚本
└── README.md           # 项目说明
```

## API接口

### 文件上传和解析
- **URL**: `/api/exam/upload`
- **方法**: POST
- **参数**: file (Word文档)
- **返回**: 解析后的题目数据

### 考试提交和计分
- **URL**: `/api/exam/submit`
- **方法**: POST
- **参数**: questions (题目), user_answers (用户答案)
- **返回**: 计分结果和详细分析

## 注意事项

1. Word文档必须严格按照指定格式编写
2. 题目编号必须是数字加点的格式（如"1."）
3. 选项必须以字母加顿号或点开头（如"A、"或"A."）
4. 答案行必须以"答案:"开头
5. 单选题和多选题需要用相应的标题行标记

## 故障排除

### 常见问题

1. **文件上传失败**
   - 检查文件格式是否为.docx或.doc
   - 确认文件大小不超过限制

2. **题目解析错误**
   - 检查Word文档格式是否符合要求
   - 确认题目编号、选项格式正确

3. **服务器无法启动**
   - 检查端口5001是否被占用
   - 确认Python虚拟环境已激活
   - 检查依赖是否正确安装

## 开发者信息

本项目使用Flask框架开发，支持扩展和定制。如需添加新功能或修改现有功能，请参考Flask官方文档。

## 许可证

本项目仅供学习和研究使用。

